var _yelpWidget=(function(){var a={reviewsElement:$("#userReviews"),title:$("#businessTitle"),userReviews:$("#userReviews"),widgetBody:$(".widget-body")};var h={};function j(){h.widget=$("#yelpWidget");h.logo=$("#yelpLogo");h.reviewers=$("#reviewesCount");applyDefaultSettings();h.reviewsCount=yelpModel.businessData.getReviewCount();h.reviews=yelpModel.businessData.getReviews();h.buttonSize=yelpModel.settings.buttonSize;h.title=yelpModel.businessData.getName();h.widgetBGColor=yelpModel.settings.widgetTransparent?"transparent":yelpModel.settings.widgetBGColor;h.reviewsBGColor=yelpModel.settings.reviewsTransparent?"transparent":yelpModel.settings.reviewsBGColor;h.headlineTextColor=yelpModel.settings.headlineTextColor;h.reviewsTextColor=yelpModel.settings.reviewsTextColor;h.onClickAction=yelpModel.settings.onClickAction||"doNothing";if(yelpModel.settings.toggleReviews==="showReviews"){$(a.reviewsElement).removeClass("hidden")}else{$(a.reviewsElement).addClass("hidden")}b(h.title);g(h.buttonSize);c(h.reviews);d(h.reviewsCount);k(h.onClickAction);i(h.widgetBGColor,h.reviewsBGColor,h.headlineTextColor,h.reviewsTextColor)}function k(l){if(l==="gotoYelpProfile"){$("#clickable-area").click(function(){window.open(yelpModel.businessData._data.url,"_blank")})}}function i(n,o,m,l){if(n){a.widgetBody.css("background-color",n)}if(o){a.userReviews.css("background-color",o)}if(m){a.title.css("color",m)}if(l){$("#userReviews").children().css("color",l)}}function b(l){if(!l){return}a.title.html(l)}function d(l){if(!h){return}h.reviewers.html(l+" Reviews")}function c(p,n){for(var o=0;o<p.length;o++){var r=p[o];var q=e(p[o].time_created);var m=$("#userReview").html();var l=Handlebars.compile(m)({reviewId:r.id,userId:yelpModel.businessData._data.id,userAvatar:r.user.image_url,userName:r.user.name,userRating:r.rating_image_url,reviewDate:f(new Date(q)),reviewText:r.excerpt});a.reviewsElement.append(l)}}function g(l){if(!h){return}$("#yelpStars").find("img").attr("src",yelpModel.businessData.getRatingImageUrl(l));$("#yelpStars").attr("href","http://yelp.com/biz/"+yelpModel.settings.businessId);$("#yelpStars").show()}function f(n){var o=n.getDate();var l=n.getMonth()+1;var p=n.getFullYear();return""+(l<=9?"0"+l:l)+"/"+(o<=9?"0"+o:o)+"/"+p}function e(l){var n=l.toString();if(n.length<13){for(var m=n.length;m<13;m++){l=l*10}}return l}return{init:j,setReviewsCount:d,setStars:g}}());function showYelpBusinessInfo(){_yelpWidget.init()}$(document).ready(function(){window.yelpModel={};readsettings(function(b){try{yelpModel.settings=!!b?JSON.parse(b):{}}catch(a){return}applyDefaultSettings();if(!yelpModel.settings.businessId){yelpModel.settings.businessId="wix-lounge-sf-san-francisco"}if(yelpModel.settings.businessId){_WixYelp.Init(yelpModel.settings.businessId,function(c){if(c===null){return}yelpModel.businessData=c;showYelpBusinessInfo()})}},Wix.Utils.getCompId())});